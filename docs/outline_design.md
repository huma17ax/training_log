# 概要設計

## システム概要

トレーニング記録を管理するWebアプリケーション。ユーザーは種目ごとのトレーニング内容（重量、セット数、回数など）を記録し、進捗をグラフや統計情報で確認できます。

## システム構成

- フロントエンド: Vue.js + TypeScript
  - 状態管理: Pinia
  - UIフレームワーク: Vuetify
  - グラフ描画: Chart.js
- バックエンド: Firebase
  - データベース: Cloud Firestore
  - 認証: Firebase Authentication（Google認証）
  - ホスティング: Firebase Hosting

## 機能要件

### 認証機能

- Googleアカウントによるログイン
  - ログイン状態の永続化
  - 自動ログアウト（24時間）
- セッション管理
  - トークンのリフレッシュ
  - セキュアなセッション維持

### トレーニング記録管理

- 5種目のトレーニング記録
  - ランニング（距離、時間、ペース）
  - レッグプレス（重量、セット数、回数）
  - チェストプレス（重量、セット数、回数）
  - ラットプルダウン（重量、セット数、回数）
  - アブドミナル（セット数、回数）
- 記録の閲覧・編集・削除
  - カレンダー表示
  - リスト表示
  - 種目別フィルタリング
- 進捗の可視化
  - 種目別の重量推移グラフ
  - 月間トレーニング頻度
  - 部位別トレーニング比率

### データ管理

- リアルタイムデータ同期
  - 複数デバイス間の同期
  - 競合解決
- オフライン対応
  - ローカルストレージへの保存
  - 再接続時の自動同期
- データバックアップ
  - 日次自動バックアップ
  - 手動バックアップ

## コンポーネント構成

### ビュー層

- ログイン画面
  - Google認証ボタン
  - エラー表示
- メイン画面
  - タブナビゲーション
  - ログアウトボタン
  - ユーザー情報
- トレーニング記録画面
  - 種目別タブ
  - 入力フォーム
  - 記録リスト
  - 進捗グラフ

### 機能層

- 認証管理
  - ログイン処理
  - セッション管理
  - エラーハンドリング
- データ同期
  - Firestore連携
  - キャッシュ管理
- 統計処理
  - データ集計
  - 進捗計算
- グラフ生成
  - データ整形
  - グラフ描画

### データ層

- ローカルストア
  - 認証情報
  - アプリケーション設定
  - キャッシュデータ
- Firestoreデータベース
  - ユーザー情報
  - トレーニング記録
  - 設定情報

## データフロー

1. ユーザー認証
   - Google認証
   - トークン管理
2. トレーニングデータの取得・同期
   - リアルタイム同期
   - キャッシュ管理
3. ローカルでのデータ処理
   - バリデーション
   - 一時保存
4. サーバーへのデータ同期
   - バッチ処理
   - エラー処理

## 状態管理

### グローバル状態

- ユーザー情報
  - プロフィール
  - 設定
- 認証状態
  - ログイン状態
  - トークン情報
- アプリケーション設定
  - テーマ設定
  - 表示設定

### ローカル状態

- フォーム入力
  - バリデーション
  - 一時保存
- UI状態
  - タブ選択
  - モーダル表示
- 一時データ
  - フィルター条件
  - ソート条件

## セキュリティ設計

- 認証管理
  - トークン管理
  - セッション制御
- データアクセス制御
  - ユーザーごとのデータ分離
  - 権限管理
- 入力検証
  - サニタイズ
  - バリデーション
- エラー処理
  - エラーログ
  - ユーザー通知

## 画面設計方針

- レスポンシブデザイン
  - ブレークポイント（SP/TB/PC）
  - グリッドレイアウト
- モバイルファースト
  - タッチ操作最適化
  - 画面遷移の最適化
- アクセシビリティ対応
  - WAI-ARIA対応
  - キーボード操作
- 直感的なUI/UX
  - 視認性の確保
  - 操作性の向上

## テスト方針

- ユニットテスト
  - コンポーネント
  - ユーティリティ
- 統合テスト
  - 認証フロー
  - データフロー
- E2Eテスト
  - ユースケース
  - エラーケース

## 非機能要件

### パフォーマンス

- 初期ロード時間: 2秒以内
- データ同期: 1秒以内
- レスポンス時間: 0.5秒以内

### スケーラビリティ

- 同時接続数: 1000ユーザー
- データ容量: ユーザーあたり100MB
- 処理性能: 1秒あたり100リクエスト

### メンテナンス性

- コード品質
  - TypeScript利用
  - ESLint/Prettier
- ドキュメント管理
  - API仕様書
  - コンポーネント仕様書
- バージョン管理
  - セマンティックバージョニング
  - 変更履歴管理

### ユーザビリティ

- 操作性の向上
  - ショートカットキー
  - ドラッグ&ドロップ
- エラー防止
  - 入力補助
  - 確認ダイアログ
- ヘルプ機能
  - チュートリアル
  - ツールチップ

## 制約条件

### ブラウザ対応

- モダンブラウザ
  - Chrome/Firefox/Safari/Edge最新版
- モバイルブラウザ
  - iOS Safari/Android Chrome最新版

### デバイス要件

- スマートフォン
  - iOS 14以上
  - Android 10以上
- タブレット
  - iPad OS 14以上
  - Android 10以上
- デスクトップ
  - Windows 10以上
  - macOS 11以上

### ネットワーク

- オフライン対応
  - データの永続化
  - 同期管理
- 低速回線対応
  - プログレッシブローディング
  - データ圧縮

## 将来の拡張性

### 機能拡張

- 新しいトレーニング種目
  - カスタム種目の追加
  - テンプレート機能
- ソーシャル機能
  - シェア機能
  - フォロー機能
- 目標設定機能
  - 目標値の設定
  - 達成度管理

### 統合

- 外部デバイス連携
  - スマートウォッチ
  - フィットネス機器
- 他のアプリ連携
  - Google Fit
  - Apple Health
- API提供
  - REST API
  - WebSocket API
